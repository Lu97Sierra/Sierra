var e=10,r=20,s=30,t=40,i=50,l=60,n={trace:10,debug:20,info:30,warn:40,error:50,fatal:60},o={};function a(e){return"string"==typeof e?n[e.toLowerCase()]:e}function c(e){if(null==e)return e;if(Array.isArray(e))return e.slice();if("object"==typeof e){const r={};return Object.keys(e).forEach(function(s){r[s]=e[s]}),r}return e}function h(e){return void 0===e?"undefined":null===e?"null":Array.isArray(e)?"[ "+e.map(e=>h(e)).join(", ")+" ]":"object"==typeof e?JSON.stringify(e):"function"==typeof e?"[Function: "+e.name+"]":"boolean"==typeof e||"number"==typeof e?e:"'"+e.toString()+"'"}function f(e){if("string"!=typeof e){const e=new Array(arguments.length);for(let r=0;r<arguments.length;r++)e[r]=h(arguments[r]);return e.join(" ")}const r=/%[sdj%]/g;let s=1;const t=arguments,i=t.length;let l=String(e).replace(r,e=>{if("%%"===e)return"%";if(s>=i)return e;switch(e){case"%s":return String(t[s++]);case"%d":return Number(t[s++]);case"%j":try{return JSON.stringify(t[s++])}catch(e){return"[Circular]"}default:return e}});for(let e=t[s];s<i;e=t[++s])l+=null===e||"object"!=typeof e?" "+e:" "+h(e);return l}function u(e,r){const s=e.split("\n");s[0]&&s[0].indexOf("call-stack-error")>=0&&s.shift();const t=s[r];let i=null;if(t){const e=/^\s*(at|.*@)\s*(.+)?$/.exec(t);i=Array.isArray(e)&&e[2]?e[2]:t}return i}Object.keys(n).forEach(function(e){o[n[e]]=e});const m={};function v(e,r){if(r){if(m[r])return;m[r]=!0}console.error(e+"\n")}function p(e){return m[e]}function y(){const e=[];return(r,s)=>s&&"object"==typeof s?-1!==e.indexOf(s)?"[Circular]":(e.push(s),s):s}var d=/*#__PURE__*/function(){function e(){}return e.prototype.write=function(e){e.level<30?console.log(e):e.level<40?console.info(e):e.level<50?console.warn(e):console.error(e),e.err&&e.err.stack&&console.error(e.err.stack),e.obj&&console.log(e.obj)},e}();class g{constructor(e,r,s){if(!(this instanceof g))return new g(e,r);let t,i,l,n;if(void 0!==r&&(t=e,e=r,!(t instanceof g)))throw new TypeError("invalid Logger creation: do not pass a second arg");if(!e)throw new TypeError("options (object) is required");if(t){if(e.name)throw new TypeError("invalid options.name: child cannot set logger name")}else if(!e.name)throw new TypeError("options.name (string) is required");if(e.stream&&e.streams)throw new TypeError('cannot mix "streams" and "stream" options');if(e.streams&&!Array.isArray(e.streams))throw new TypeError("invalid options.streams: must be an array");if(e.serializers&&("object"!=typeof e.serializers||Array.isArray(e.serializers)))throw new TypeError("invalid options.serializers: must be an object");if(t&&s){this._level=t._level,this.streams=t.streams,this.serializers=t.serializers,this.src=t.src,i=this.fields={};const r=Object.keys(t.fields);for(n=0;n<r.length;n++)l=r[n],i[l]=t.fields[l];const s=Object.keys(e);for(n=0;n<s.length;n++)l=s[n],i[l]=e[l]}else{if(t){for(this._level=t._level,this.streams=[],n=0;n<t.streams.length;n++){const e=c(t.streams[n]);this.streams.push(e)}this.serializers=c(t.serializers),this.src=t.src,this.fields=c(t.fields),e.level&&this.level(e.level)}else this._level=Number.POSITIVE_INFINITY,this.streams=[],this.serializers=null,this.src=!1,this.fields={};e.stream?this.addStream({type:"stream",stream:e.stream,level:e.level}):e.streams?e.streams.forEach(r=>{this.addStream(r,e.level)}):t&&e.level?this.level(e.level):t||this.addStream({type:"raw",stream:new d,level:e.level}),e.serializers&&this.addSerializers(e.serializers),e.src&&(this.src=!0),i=c(e),delete i.stream,delete i.level,delete i.streams,delete i.serializers,delete i.src,this.serializers&&this._applySerializers(i),Object.keys(i).forEach(e=>{this.fields[e]=i[e]})}}addStream(e,r=30){(e=c(e)).type="raw",e.level=a(e.level||r),e.level<this._level&&(this._level=e.level),this.streams.push(e),delete this.haveNonRawStreams}addSerializers(e){this.serializers||(this.serializers={}),Object.keys(e).forEach(r=>{const s=e[r];if("function"!=typeof s)throw new TypeError(f('invalid serializer for "%s" field: must be a function',r));this.serializers[r]=s})}child(e,r){return new this.constructor(this,e||{},r)}level(e){if(void 0===e)return this._level;const r=a(e),s=this.streams.length;for(let e=0;e<s;e++)this.streams[e].level=r;this._level=r}levels(e,r){if(void 0===e)return this.streams.map(e=>e.level);let s;if("number"==typeof e){if(s=this.streams[e],void 0===s)throw new Error("invalid stream index: "+e)}else{const r=this.streams.length;for(let t=0;t<r;t++){const r=this.streams[t];if(r.name===e){s=r;break}}if(!s)throw new Error(f('no stream with name "%s"',e))}if(void 0===r)return s.level;{const e=a(r);s.level=e,e<this._level&&(this._level=e)}}_applySerializers(e,r){Object.keys(this.serializers).forEach(s=>{if(!(void 0===e[s]||r&&r[s]))try{e[s]=this.serializers[s](e[s])}catch(r){v(f('bunyan: ERROR: Exception thrown from the "%s" Bunyan serializer. This should never happen. This is a bugin that serializer function.\n%s',s,r.stack||r)),e[s]=f('(Error in Bunyan log "%s" serializer broke field. See stderr for details.)',s)}})}_emit(e,r){let s,t;if(void 0===this.haveNonRawStreams)for(this.haveNonRawStreams=!1,s=0;s<this.streams.length;s++)if(!this.streams[s].raw){this.haveNonRawStreams=!0;break}if(r||this.haveNonRawStreams)try{t=JSON.stringify(e,y())+"\n"}catch(r){const s=r.stack.split(/\n/g,2).join("\n");v('bunyan: ERROR: Exception in `JSON.stringify(rec)`. You can install the "safe-json-stringify" module to have Bunyan fallback to safer stringification. Record:\n'+(i=f("%s\n%s",e,r.stack),l||(l="    "),l+i.split(/\r?\n/g).join("\n"+l)),s),t=f("(Exception in JSON.stringify(rec): %j. See stderr for details.)\n",r.message)}var i,l;if(r)return t;const n=e.level;for(s=0;s<this.streams.length;s++){const r=this.streams[s];r.level<=n&&r.stream.write(e)}return t}}function w(e){return function(){const r=this;function s(s){let l;s[0]instanceof Error?(t={err:r.serializers&&r.serializers.err?r.serializers.err(s[0]):j.err(s[0])},l={err:!0},i=1===s.length?[t.err.message]:Array.prototype.slice.call(s,1)):"object"!=typeof s[0]&&null!==s[0]||Array.isArray(s[0])?(t=null,i=Array.prototype.slice.call(s)):(t=s[0],i=1===s.length&&t.err&&t.err instanceof Error?[t.err.message]:Array.prototype.slice.call(s,1));const n=c(r.fields);n.level=e;const a=t?c(t):null;if(a&&(r.serializers&&r._applySerializers(a,l),Object.keys(a).forEach(e=>{n[e]=a[e]})),n.levelName=o[e],n.msg=i.length?f.apply(r,i):"",n.time||(n.time=new Date),r.src&&!n.src)try{throw new Error("call-stack-error")}catch(e){const r=e.stack?u(e.stack,2):"";r||p("src")||v("Unable to determine src line info","src"),n.src=r||""}return n.v=1,n}let t=null,i=arguments,l=null;if(0===arguments.length)return this._level<=e;this._level>e||(l=s(i),this._emit(l))}}function b(e){let r=e.stack||e.toString();if(e.cause&&"function"==typeof e.cause){const s=e.cause();s&&(r+="\nCaused by: "+b(s))}return r}g.prototype.trace=w(10),g.prototype.debug=w(20),g.prototype.info=w(30),g.prototype.warn=w(40),g.prototype.error=w(50),g.prototype.fatal=w(60);const j={err:function(e){return e&&e.stack?{message:e.message,name:e.name,stack:b(e),code:e.code,signal:e.signal}:e}};function z(...e){return new g(...e)}var S={levels:{trace:"color: DeepPink",debug:"color: GoldenRod",info:"color: DarkTurquoise",warn:"color: Purple",error:"color: Crimson",fatal:"color: Black"},def:"color: DimGray",msg:"color: SteelBlue",src:"color: DimGray; font-style: italic; font-size: 0.9em"},k=/*#__PURE__*/function(){function e(e){var r=void 0===e?{}:e,s=r.logByLevel,t=r.css,i=void 0===t?S:t;this.logByLevel=void 0!==s&&s,this.css=i}return e.prototype.write=function(e){var r,s,t=this.css.def,i=this.css.msg,l=this.css.src,n=e.childName?e.name+"/"+e.childName:e.name,a=o[e.level],c=(Array(6-a.length).join(" ")+a).toUpperCase();this.logByLevel?(10===e.level?a="debug":60===e.level&&(a="error"),s="function"==typeof console[a]?console[a]:console.log):s=console.log,r=e.level<20?this.css.levels.trace:e.level<30?this.css.levels.debug:e.level<40?this.css.levels.info:e.level<50?this.css.levels.warn:e.level<60?this.css.levels.error:this.css.levels.fatal;var h=function(e,r){return Array(r+1-(e+"").length).join("0")+e},f=[];f.push("[%s:%s:%s:%s] %c%s%c: %s: %c%s "+(e.src?"%c%s":"")),f.push(h(e.time.getHours(),2)),f.push(h(e.time.getMinutes(),2)),f.push(h(e.time.getSeconds(),2)),f.push(h(e.time.getMilliseconds(),4)),f.push(r),f.push(c),f.push(t),f.push(n),f.push(i),f.push(e.msg),e.src&&(f.push(l),f.push(e.src)),e.obj&&(f.push("\n"),f.push(e.obj)),e.err&&e.err.stack&&(f.push("\n"),f.push(e.err.stack)),s.apply(console,f)},e.getDefaultCss=function(){return S},e}(),E=/*#__PURE__*/function(){function e(e){var r=(void 0===e?{}:e).logByLevel;this.logByLevel=void 0!==r&&r}return e.prototype.write=function(e){var r,s=e.childName?e.name+"/"+e.childName:e.name,t=o[e.level],i=(Array(6-t.length).join(" ")+t).toUpperCase();this.logByLevel?(10===e.level?t="debug":60===e.level&&(t="error"),r="function"==typeof console[t]?console[t]:console.log):r=console.log;var l=function(e,r){return Array(r+1-(e+"").length).join("0")+e},n="["+l(e.time.getHours(),2)+":";n+=l(e.time.getMinutes(),2)+":",n+=l(e.time.getSeconds(),2)+":",n+=l(e.time.getMilliseconds(),4)+"] ",n+=i+": ",n+=s+": ",n+=e.msg,e.src&&(n+=" ("+e.src+")"),r.call(console,n),e.err&&e.err.stack&&r.call(console,e.err.stack),e.obj&&r.call(console,e.obj)},e}();export{k as ConsoleFormattedStream,E as ConsolePlainStream,d as ConsoleRawStream,r as DEBUG,i as ERROR,l as FATAL,s as INFO,g as Logger,e as TRACE,t as WARN,z as createLogger,n as levelFromName,o as nameFromLevel,a as resolveLevel,y as safeCycles,j as stdSerializers};
//# sourceMappingURL=index.modern.js.map
